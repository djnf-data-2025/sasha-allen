---
title: "Disconnected Youth in Connecticut"
output: html_document
date: "2025-04-22"
---

Students in Connecticut are failing. In 2022, one in three students were at risk of not graduating high school, and chronic absenteeism rates are currently at some of the highest levels the state has seen. Despite this, local, state and federal government are spending more money per-student on the education system than they ever have. Spending in Connecticut hit $19,734 per-student in the 2021 to 2022 school year sitting over $1,000 higher than the national average of $18,614 per student. (https://nces.ed.gov/fastfacts/display.asp?id=66#)

The state has coined this as the Disconnected Youth Crisis, with consequences that lead to young people not entering the job market or pursuing higher education after either dropping out or graduating. The state created a method of looking at the overall performance of their schools called the Next Generation Accountability System which is based off of 12 broad factor indicators of student performance. Each school has a point maximum based on the opportunities and level of school (ex elementary schools have lower maximum points because they don't have graduation rates). In this data is the accountability index, or the percentage of the total number of possible points a school was able to get based on their ELA, math and science test scores, split up by overall test performance as well as the performance index for high-needs students. Other factors are also taken into consideration, but these are the main ones. However, despite heightened spending in the state on students, the accountability index state-wide has been increasing dramatically.

This story is extremely timely because this issue has been brought to light in the past two years. A report was published in October of 2023 detailing the failures of the state, and this report has sparked the introduction of legislation into the Connecticut Senate. The legislation proposed an increase in funding for at-risk students and better data collection methods and data collaboration.

The target audience for this story is anyone in Connecticut who is in the school system or knows anyone involved in the school system including parents, teachers, students, family members and friends of students. This way, they can be more informed on what the state is trying to do as well as the contributing factors to the crisis.

People to interview are: Rep. Anthony L. Nolan, he introduced a bill to increase education funding. Donna Hamzy, helped craft the Young People's Plan, which is a ten year plan for funding to help the crisis. Someone who testified during the legislative hearings could be a good place to start finding people closely connected to the issue, preferably a student who has experienced disconnection in the school system. (<https://www.cga.ct.gov/aspx/CGADisplayTestimonies/CGADisplayTestimony.aspx?bill=SB-01511&doc_year=2025>)

This could possibly impact the funding for education, although it seems like there is already some initiative to change policy. Hopefully from this more nonprofits will be able to help supplement in high need areas from this as well.

I was mainly interested in this story because I had never heard of the disconnected youth crisis before and for a rich state known for having a fairly good education system, and wondered why so many students were at risk of dropping out. I think it will be impactful to see who this actually is effecting the most, and what types of supports are offered in these areas.

Photo and graphics: I have my double-axis graph comparing state per-pupil funding and , but I also want to create an interactive choropleth map based on the accountability index where you click on a town and are able to see the graduation rate, per-pupil funding and accountability index compared directly to the state averages. 
  (I am not sure if this is too ambitious. If it is, I could dumb it down and and just include these other statistics on the details of each town. The comparison would be harder though.)

Estimated delivery is beginning of July.

As for what I still need to do, I am hoping to make some more progress with my map. The district map I am using in datawrapper does has some gaps in the template so I am hoping to refine the data and use towns. I also want to recreate my double axis graph in datawrapper or flourish for a bit of visual consistency.

<iframe title="Where are students struggling the most?" aria-label="Map" id="datawrapper-chart-big1o" src="https://datawrapper.dwcdn.net/big1o/3/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="400" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
</script>


```{r}
library(tidyverse)
library(janitor)
library(readxl)
library(rvest)
library(tidycensus)
library(scales)
library(stringr)
library(readr)
```

```{r}
#disconnected youth data
next_gen <- read.csv("../data/next_gen.csv") |> 
    clean_names()
#zip code data (disconnected youth has no zip)
zips_ct <- read.csv("../data/zips_ct.csv")|>
  clean_names()

zips_ct <- zips_ct |> rename(
  reporting_district_code = organization_code,
)

#per pupil funding data split down to the district, 2017 to 2022  https://public-edsight.ct.gov/overview/per-pupil-expenditures-by-function---district/per-pupil-expenditures-by-funding-source---summary?language=en_US

pp_21_22 <- read.csv("../data/per_pupil_2122.csv")|>
  clean_names() |>
  mutate(year = "21-22")

pp_20_21 <- read.csv("../data/per_pupil_2021.csv")|>
  clean_names()|>
  mutate(year = "20-21")

pp_19_20 <- read.csv("../data/per_pupil_1920.csv")|>
  clean_names()|>
  mutate(year = "19-20")

pp_18_19 <- read.csv("../data/per_pupil_1819.csv")|>
  clean_names()|>
  mutate(year = "18-19")

pp_17_18 <- read.csv("../data/per_pupil_1718.csv")|>
  clean_names()|>
  mutate(year = "17-18")
  
per_pupil_all <- bind_rows(pp_17_18, pp_18_19, pp_19_20, pp_20_21, pp_21_22)

per_pupil_all <- per_pupil_all|> rename(
  reporting_district_code = district_code,
)

#statewide per pupil funding 
pp_statewide <- read.csv("../data/per_pupil_state2.csv")|>
  clean_names()

#graduation rate
graduation_rate_state<- read.csv("../data/state_graduation.csv")|>
  clean_names()
  
graduation_rate <- read.csv("../data/graduation_rates1.csv")|>
  clean_names()

#dropout rate by district
dropout_rate <- read.csv("../data/dropout_rates1.csv")|>
  clean_names()

#percent of students in high school for more than four years
still_enrolled <- read.csv("../data/over_four_year_enrollment.csv")|>
  clean_names()

#enrollment by district 
enrollment_district <- read.csv("../data/enrollement_district.csv")|>
  clean_names()

```


```{r}
#converting the year in per-pupil statewide data to just include the year in the fall of the school year so i can use it in the graphs below

pp_statewide <- pp_statewide |>
  mutate(
    # Remove $ and commas, convert to numeric
    ppe_numeric = str_remove_all(ppe, "[$,]") |> as.numeric(),
    # Format numeric values with commas
    ppe_formatted = comma(ppe_numeric)
  )

```

```{r}
#filter out percent
next_gen_pct <- next_gen |>
  filter(category == "DistrictTot")|>
  select(rptng_district_name, reporting_district_code, total_points, total_possible_points, fall_of_year, accountability_index) 

next_gen2022 <- next_gen_pct |>
  filter(fall_of_year == 2022)

write_csv(next_gen2022, "next_gen2022.csv")

#join dataset w/ zips and town name to the disconnected dataset (could use this for viz purposes)
zips_ct_selected <- zips_ct |> select(zipcode, reporting_district_code, town)
zip_percentage <- left_join(next_gen_pct, zips_ct_selected, by = "reporting_district_code")

#zip for 2021-2022 per pupil funding 
pp_21_22 <- left_join(pp_21_22, zips_ct_selected, by = c("district_code" = "reporting_district_code"))

#dropout, graduation, and still in school data 
dropout_rate <- dropout_rate |> rename(
  reporting_district_code = district_code,
)

still_enrolled <- still_enrolled|> rename(
  reporting_district_code = district_code,
)

graduation_rate <- graduation_rate |> rename(
  reporting_district_code = district_code,
)

dropout_rate <- left_join(dropout_rate, zips_ct_selected, by = "reporting_district_code")

graduation_rate <- left_join(graduation_rate, zips_ct_selected, by = "reporting_district_code")

still_enrolled <- left_join(still_enrolled, zips_ct_selected, by = "reporting_district_code")

#add zips to the per-pupil funding dataset
per_pupil_all <- left_join(per_pupil_all, zips_ct_selected, by = "reporting_district_code")

#counties with the highest rates of disconnected youth
#zip_pct_peryear <- zip_percentage |>
 # summarise(yearly_pct_avg = sum()
 # )
```


```{r}
#this is per-pupil funding stats that combine local, fed and state funding split down by zipcode, just for the 2021 to 2022 school year. 
pp_21_22 |>
  arrange(total) |>
  select(total, zipcode, district)
```

```{r}
#finding districts and zip codes with the highest dropout rates (this is hard because there is not data for all districts)
dropout_rate |>
  arrange(desc(x2021_22)) |>
  select(x2021_22, zipcode, district)
```


```{r}
graduation_rate |>
  arrange(x2021_22) |>
  select(x2021_22, zipcode, district)
```
```{r}
next_gen_state <- next_gen |>
  filter(school_name == "State of Connecticut")|>
  select(fall_of_year, category, total_points, total_possible_points, accountability_index)|>
  arrange(fall_of_year)
```

```{r}
pp_statewide <- pp_statewide |>
  mutate(fall_of_year = str_sub(year, 1, 4) %>% as.numeric())
```


```{r}
#The higher the accountability index, the better prepared students are. Students have been doing worse in the state since 2014 based on a series of factors. There was no data for 2019 or 2020.
ggplot(next_gen_state, aes(x = fall_of_year, y = accountability_index)) +
  geom_line(color = "blue", size = .5) +
  ylim(65, 80) +
  geom_point(color = "darkblue", size = 1) +  # optional points
  labs(
    #title is horrible but this was just for comparison purposes
    title = "Accountability Index by Year",
    x = "Fall of School Year",
    #this is based on the accountability index scores, or  the percent of the total number of possible points received based on the scoring system
    y = "Percent of total possible points recieved"
  ) +
  theme_minimal()
```
```{r}
#this is the per-pupil funding statewide in a rough graph. Despite a pretty steady increase in per-pupil funding, there is still a steady decrease in the accountability index (a high accountability index is good). I think this would be a great focus for the story, but i need to break down into a more micro view to see issues in specific counties.
ggplot(pp_statewide, aes(x = fall_of_year, y = ppe_numeric)) +
  geom_line(color = "blue", size = .5) +
  ylim(14000, 20000) +
  geom_point(color = "darkblue", size = 1) +  # optional points
  labs(
    title = "Connecticut Per-Pupil Funding Over Time",
    x = "Fall of school year",
    y = "Per-Pupil Funding"
  ) +
  theme_minimal()
```
```{r}
double_axis <- left_join(pp_statewide, next_gen_state, by = "fall_of_year")
```

```{r}
#double plot, however i have no idea how to have 2021 and 2022 show up on here for the accountability index so i am still working on it but these both are quite low as well. there is no data for 2019 and 2020 

ggplot(double_axis, aes(x = fall_of_year)) +
  geom_point(aes(y = ppe_numeric), color = "red", size = 2) +
  geom_line(aes(y = ppe_numeric), color = "red", size = .5) +
  geom_point(aes(y = (accountability_index - 70) * (6000 / 10) + 14000), color = "blue", size = 2) +
  geom_line(aes(y = (accountability_index - 70) * (6000 / 10) + 14000), color = "blue", size = .5) +
  scale_y_continuous(
    name = "Per-Pupil Expenditure (Red)",
    limits = c(14000, 20000),
    sec.axis = sec_axis(
      trans = ~ (. - 14000) * (10 / 6000) + 70,
      name = "Accountability Index (Blue)",
      breaks = seq(70, 80, 2)
    )
  ) +
scale_x_continuous(
  limits = c(2012, 2022),
  breaks = seq(2012, 2022, 2),
  labels = seq(2012, 2022, 2),
  expand = expansion(mult = c(.01, .01))
)+
  labs(
    title = "Connecticut Per-Pupil Funding Over Time",
    y = "Per-Pupil Funding",
    x = "Fall of School Year"
  ) +
  theme_minimal()+
    theme(
    axis.title.x = element_text(margin = margin(t = 15)),  
    axis.title.y = element_text(margin = margin(r = 15)),
    axis.title.y.right = element_text(margin = margin(l = 15)),
    plot.title = element_text(margin = margin(b=15))
    )
```
```{r}
graduation_rate_long <- graduation_rate_state |> 
  pivot_longer(
    cols = starts_with("x"),       # or: cols = -district
    names_to = "school_year", 
    values_to = "grad_rate"
  )

```


#i have a bunch of notes and stuff down here this section is my brainstorming 
```{r}
#grad rate
#ggplot(graduation_rate_state, aes(x = school_year, y = grad_rate)) +
  #geom_line(color = "blue", size = .5) +
  #ylim(14000, 20000) +
  #geom_point(color = "darkblue", size = 1) +  # optional points
  #labs(
   # title = "Connecticut Graduation Rate",
   # x = "Fall of school year",
   # y = "Graduation Rate"
 # ) +
  #theme_minimal()
```
```{r}
per_pupil_parsed <- per_pupil_all |>
  mutate(total = parse_number(total))
```

```{r}
#im going to use this to find the towns with the lowest and highest accountability index in 2022 and to make a map. i am going to create a double bar chart comparing average per pupil funding for 2022 in each town with this accountability index for 2022

#accountability index filter and averaging (average of districts in each town, i think town may be more readable in a graphic)

zip_percentage_graphic <- zip_percentage |>
  filter(fall_of_year == "2022")

pct_graphic <- zip_percentage_graphic |>
  select(town, accountability_index, fall_of_year)

pct_graphic |>
  group_by(town) |>
  summarise(
    avg_accountability_index = mean(accountability_index, na.rm = TRUE),
    .groups = "drop"
  )


#averaging the per pupil funding
per_pupil_graphic <-per_pupil_parsed |>
  filter(year == "21-22")

pp_graphic <- per_pupil_graphic|>
  select(total, town, year)

pp_graphic |>
  group_by(town) |>
  summarise(
    total = mean(total, na.rm = TRUE),
    .groups = "drop"
  )





```

```{r}
str(per_pupil_all)
```


